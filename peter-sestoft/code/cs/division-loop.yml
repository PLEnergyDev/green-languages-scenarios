name: division-loop
language: cs
code: |
    using System.Runtime.InteropServices;

    public class Program {
        [DllImport("libsignals", EntryPoint = "start_gl")]
        public static extern bool start_gl();

        [DllImport("libsignals", EntryPoint = "end_gl")]
        public static extern void end_gl();

        static void run_benchmark(string[] args) {
            int m = int.Parse(args[0]);
            double sum = 0.0;
            int n = 0;
            while (sum < m) {
                n++;
                sum += 1.0 / n;
            }
            Console.WriteLine(n);
        }

        public static void Main(string[] args) {
            while (true) {
                if (!start_gl()) break;
                run_benchmark(args);
                end_gl();
            }
        }
    }
framework: net9.0
compile_options:
    - -c Release
    - -p:ImplicitUsings=enable
    - -p:Nullable=enable
    - -p:AllowUnsafeBlocks=true
    - -p:ServerGarbageCollection=true
    - -p:ConcurrentGarbageCollection=true
    - -p:UseSharedCompilation=false
    - -p:OptimizationPreference=Speed
    - -p:IlcInstructionSet=native
arguments: [20]
expected_stdout: !!binary MjcyNDAwNjAwCg==
niceness: -20
affinity: [5]
---
name: release
mode: internal
---
name: release
mode: external
